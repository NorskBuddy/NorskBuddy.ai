<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Norsk Buddy</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:system-ui,sans-serif;background:linear-gradient(135deg,#1cb0f6,#58cc02);}
.app{max-width:480px;margin:auto;background:#fff;min-height:100vh;padding:20px;position:relative;}
h1,h2{text-align:center;}
.hidden{display:none;}
button{width:100%;padding:12px;margin:8px 0;font-size:16px;border:none;border-radius:12px;background:#58cc02;color:white;cursor:pointer;}
button.secondary{background:#1cb0f6;}
.lesson-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;margin-top:20px;}
.lesson{background:#f0f8ff;border-radius:16px;padding:16px;text-align:center;cursor:pointer;position:relative;}
.lesson.done::after{content:"‚úÖ";position:absolute;top:8px;right:10px;}
.option{background:#eee;color:#333;margin:4px;padding:10px;border-radius:8px;cursor:pointer;}
.option.correct{background:#58cc02;color:white;}
.option.wrong{background:#e74c3c;color:white;}
.score{text-align:center;font-weight:bold;margin:10px 0;}
.example{background:#f6f6f6;padding:8px;border-radius:8px;margin-top:10px;font-size:14px;}
#prev{position:absolute;top:12px;left:12px;width:auto;}
</style>
</head>

<body>
<div class="app">

<h1>üá≥üá¥ Norsk Buddy</h1>

<!-- HOME -->
<div id="screen-home">
  <h2>Your Journey</h2>
  <div class="lesson-grid" id="lessonGrid"></div>

  <h2 style="margin-top:30px;">Practice</h2>
  <button class="secondary" onclick="startWordPractice()">Word Practice</button>
  <button class="secondary" onclick="show('screen-custom')">Custom Practice</button>
</div>

<!-- LESSON -->
<div id="screen-lesson" class="hidden">
  <button id="prev" onclick="goHome()">‚Üê Home</button>
  <h2 id="word-no"></h2>
  <p><strong>English:</strong> <span id="word-en"></span></p>
  <button class="secondary" onclick="playAudio()">üîä Play</button>
  <button onclick="nextWord()">Next</button>
  <div id="examples"></div>
</div>

<!-- QUIZ -->
<div id="screen-quiz" class="hidden">
  <h2>Choose the correct meaning</h2>
  <div class="score" id="quizScore"></div>
  <div id="quizOptions"></div>
</div>

<!-- CUSTOM PRACTICE -->
<div id="screen-custom" class="hidden">
  <button id="prev" onclick="goHome()">‚Üê Home</button>
  <h2>Select up to 10 words</h2>
  <div id="customList"></div>
  <button onclick="startCustomPractice()">Start Practice</button>
</div>

<script>
/* ================= DATA ================= */
const lessons={
meMyselfI:{
words:[['Meg','Me'],['Jeg','I'],['Du','You'],['Meg selv','Myself'],['Deg','Yourself'],['Mine','Mine'],['Din','Your'],['v√•r','our'],['v√•rt','ours'],['hennes','hers'],['hans','his']],
examples:['Du og meg ‚Äì You and me','Hans eller hennes ‚Äì His or hers']
},
clothes:{
words:[['kl√¶r','clothes'],['Sko','shoe'],['Bukser','pants'],['Lue','beanie'],['Hatt','hat'],['Briller','glasses'],['skjorte','shirt'],['t-skjorte','t-shirt'],['joggesko','sneakers'],['dress','suit'],['kjole','dress']],
examples:['Skoene hennes er bl√•','Hatten hans er r√∏d']
},
giveTake:{
words:[['Gi','give'],['Ta','take'],['Tok','took'],['Tatt','taken'],['Ga','gave'],['Gitt','given'],['hadde gitt','had given']],
examples:['Gi meg den luen','Ta det til henne']
},
lostFound:{
words:[['mistet','lost'],['finne','find'],['funnet','found'],['borte','gone'],['har funnet','have found']],
examples:['Den er borte','Jeg mistet den i g√•r','Jeg fant det tidligere']
},
tech:{
words:[['datamaskin','computer'],['telefon','telephone'],['smarttelefon','smartphone'],['TV-en','television'],['radio','radio'],['tablett','tablet'],['videospill','video game']],
examples:['Jeg mistet telefonen min','Jeg h√∏rte det p√• radioen','Jeg spiller et videospill']
},
reading:{
words:[['bok','book'],['blad','magazine'],['avis','newspaper'],['brev','letter'],['rapport','report'],['undertekst','subtitle'],['tekstmelding','text message'],['leser','reading'],['lese','read'],['skrev','wrote'],['skriving','writing'],['skrevet','written']],
examples:['Jeg leser en ny bok','Hun skrev en rapport for magasinet']
}
};

const lessonNames={
meMyselfI:'Me, Myself, and I',
clothes:'Things You Wear',
giveTake:'Give and Take',
lostFound:'Lost and Found',
tech:'Everyday Tech',
reading:'The Reading Rainbow'
};

/* ================= STATE ================= */
let seq=[],idx=0,currentLesson=null;
let score=0,streak=0,bestStreak=localStorage.getItem('bestStreak')||0;

/* ================= HOME GRID ================= */
const grid=document.getElementById('lessonGrid');
for(let k in lessonNames){
const d=document.createElement('div');
d.className='lesson';
if(localStorage.getItem('done_'+k)) d.classList.add('done');
d.textContent=lessonNames[k];
d.onclick=()=>startLesson(k);
grid.appendChild(d);
}

/* ================= NAV ================= */
function show(id){
document.querySelectorAll('[id^=screen]').forEach(s=>s.classList.add('hidden'));
document.getElementById(id).classList.remove('hidden');
}
function goHome(){show('screen-home');}

/* ================= LESSON ================= */
function startLesson(k){
currentLesson=k;
seq=[...lessons[k].words];
idx=0;
show('screen-lesson');
showWord();
}

function showWord(){
const w=seq[idx];
document.getElementById('word-no').textContent=w[0];
document.getElementById('word-en').textContent=w[1];
const ex=document.getElementById('examples');
ex.innerHTML='';
if(idx===seq.length-1){
lessons[currentLesson].examples.forEach(e=>{
ex.innerHTML+=`<div class="example">${e}</div>`;
});
}
}

function nextWord(){
idx<seq.length-1?showWord(++idx):startSentenceQuiz();
}

/* ================= AUDIO ================= */
function playAudio(){
const t=document.getElementById('word-no').textContent;
const a=new Audio(`audio/${t}.mp3`);
a.onerror=()=>speechSynthesis.speak(new SpeechSynthesisUtterance(t));
a.play().catch(()=>speechSynthesis.speak(new SpeechSynthesisUtterance(t)));
}

/* ================= QUIZ ================= */
function startSentenceQuiz(){
show('screen-quiz');
score=0;
quizNext();
}

function quizNext(){
if(seq.length===0){
localStorage.setItem('done_'+currentLesson,1);
goHome();
return;
}
const w=seq.pop();
document.getElementById('quizScore').textContent=`Score: ${score} | Streak: ${streak}`;
const opts=shuffle([w,...shuffle(allWords()).slice(0,3)]);
const box=document.getElementById('quizOptions');
box.innerHTML='';
opts.forEach(o=>{
const b=document.createElement('button');
b.className='option';
b.textContent=o[1];
b.onclick=()=>{
if(o===w){score++;streak++;bestStreak=Math.max(bestStreak,streak);}
else streak=0;
quizNext();
};
box.appendChild(b);
});
}

/* ================= PRACTICE ================= */
function startWordPractice(){
seq=shuffle(allWords()).slice(0,18);
idx=0;currentLesson=null;
show('screen-lesson');
showWord();
}

function allWords(){
let a=[];
Object.values(lessons).forEach(l=>a.push(...l.words));
return a;
}

function shuffle(a){return a.sort(()=>Math.random()-0.5);}
</script>

</body>
</html>

