<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Norsk Buddy</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { margin:0; font-family:system-ui,sans-serif; background:linear-gradient(135deg,#1cb0f6,#58cc02); }
.app { max-width:480px; margin:auto; background:#fff; min-height:100vh; padding:20px; position:relative; }
h1,h2{text-align:center;}
.hidden{display:none;}
button{width:100%;padding:12px;margin:8px 0;font-size:16px;border:none;border-radius:12px;background:#58cc02;color:white;cursor:pointer;}
button.secondary{background:#1cb0f6;}
.section{margin-top:20px;}
.section-content{margin-top:10px;}
.lesson-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;}
.lesson{background:#f0f8ff;border-radius:16px;padding:16px;text-align:center;cursor:pointer;}
.translation-line{min-height:50px;border-bottom:2px solid #ccc;margin:10px 0;padding:6px;display:flex;gap:4px;flex-wrap:wrap;}
.bubbles{display:flex;flex-wrap:wrap;gap:6px;margin-top:12px;}
.bubble{background:#eee;color:#333;padding:8px 12px;border-radius:8px;cursor:pointer;}
.bubble.selected{background:#1cb0f6;color:white;}
.bubble.incorrect{background:#ff4d4d;color:white;}
.word-token{text-decoration:underline;cursor:pointer;}
.timer{font-size:22px;text-align:center;margin:10px;}
.score{text-align:center;font-weight:bold;}
.context-box{background:#f9f9f9;border-radius:12px;padding:14px;margin:10px 0;}
</style>
</head>
<body>
<div class="app">
<h1>üá≥üá¥ Norsk Buddy</h1>

<!-- HOME -->
<div id="screen-home">
  <button onclick="toggle('journey')">Your Journey</button>
  <div id="journey" class="section-content hidden">
    <div class="lesson-grid" id="lessonGrid"></div>
  </div>

  <button onclick="toggle('practice')">Practice</button>
  <div id="practice" class="section-content hidden">
    <button onclick="startWordPractice()">Word Practice</button>
    <button onclick="startCustomPractice()">Custom Practice</button>
  </div>

  <button onclick="toggle('tense')">Understanding Past, Present, and Future Tense</button>
  <div id="tense" class="section-content hidden">
    <button onclick="startSentenceLesson('tenseMovement')">Movement Through Time</button>
    <button onclick="startSentenceLesson('tenseEating')">Eating & Drinking</button>
    <button onclick="startSentenceLesson('tenseSpeech')">Speaking</button>
    <button onclick="startSentenceLesson('tenseSeeing')">Seeing & Finding</button>
    <button onclick="startSentenceLesson('tenseWork')">Work & Action</button>
  </div>

  <button onclick="startBeatTheClock()">Beat the Clock ‚è±Ô∏è</button>
  <button onclick="startContext()">Learn the Context</button>
</div>

<!-- SENTENCE SCREEN -->
<div id="screen-sentence" class="hidden">
  <button onclick="goHome()">‚Üê Home</button>
  <h2>Translate this sentence</h2>
  <div id="norwegianSentence"></div>
  <div id="translationLine" class="translation-line"></div>
  <div id="wordBubbles" class="bubbles"></div>
  <button onclick="checkSentence()">Check</button>
</div>

<!-- BEAT THE CLOCK -->
<div id="screen-timer" class="hidden">
  <button onclick="goHome()">‚Üê Home</button>
  <div class="timer" id="timer">2:00</div>
  <div class="score" id="score">Score: 0</div>
  <h2 id="clockWord"></h2>
  <div id="clockOptions" class="bubbles"></div>
</div>

<!-- CONTEXT -->
<div id="screen-context" class="hidden">
  <button onclick="goHome()">‚Üê Home</button>
  <h2>Learn the Context</h2>
  <div class="context-box">
    <strong>Jeg har g√•tt hjem</strong><br>
    Literally: "I have walked home"<br>
    Used to emphasize completion, not the act of walking.
  </div>
  <div class="context-box">
    <strong>Jeg skulle spise</strong><br>
    Indicates intention that may not have happened.
  </div>
</div>

<script>
function toggle(id){document.getElementById(id).classList.toggle('hidden');}
function goHome(){show('screen-home');}
function show(id){document.querySelectorAll('[id^=screen]').forEach(s=>s.classList.add('hidden'));document.getElementById(id).classList.remove('hidden');}

/* EXISTING + NEW LESSON DATA */
const lessons={
  thingsHouse:[
    ['vegg','wall'],['tak','ceiling'],['tak','roof'],['kj√∏leskap','refrigerator'],
    ['kaffemaskin','coffee machine'],['speil','mirror'],['vifte','fan'],
    ['ovn','oven'],['toalett','toilet'],['badekar','bathtub']
  ],
  roomsHouse:[
    ['bad','bathroom'],['stue','living room'],['spisestue','dining room'],
    ['soverom','bedroom'],['kjeller','basement'],['loft','attic'],['garasje','garage']
  ],
  tenseMovement:[
    ['Jeg g√•r','I walk'],['Jeg gikk','I walked'],['Jeg vil g√•','I will walk']
  ],
  tenseEating:[
    ['Jeg spiser','I eat'],['Jeg spiste','I ate'],['Jeg vil spise','I will eat']
  ],
  tenseSpeech:[
    ['Jeg snakker','I speak'],['Jeg snakket','I spoke'],['Jeg vil snakke','I will speak']
  ],
  tenseSeeing:[
    ['Jeg ser','I see'],['Jeg s√•','I saw'],['Jeg vil se','I will see']
  ],
  tenseWork:[
    ['Jeg jobber','I work'],['Jeg jobbet','I worked'],['Jeg vil jobbe','I will work']
  ]
};

/* LESSON GRID */
const grid=document.getElementById('lessonGrid');
[['thingsHouse','Things Around the House'],['roomsHouse','Rooms of a House']]
.forEach(([k,n])=>{
  const d=document.createElement('div');
  d.className='lesson';
  d.innerHTML=n;
  d.onclick=()=>startSentenceLesson(k);
  grid.appendChild(d);
});

/* SENTENCE LOGIC */
let seq=[],idx=0,current=null;
function startSentenceLesson(k){seq=[...lessons[k]];idx=0;showSentence();show('screen-sentence');}
function showSentence(){
  current=seq[idx];
  document.getElementById('norwegianSentence').textContent=current[0];
  document.getElementById('translationLine').innerHTML='';
  const bubbles=document.getElementById('wordBubbles');bubbles.innerHTML='';
  const words=current[1].split(' ');
  shuffle([...words,'the','a','is','my','your']).slice(0,words.length+3)
  .forEach(w=>{
    const b=document.createElement('div');
    b.className='bubble';b.textContent=w;
    b.onclick=()=>select(b);
    bubbles.appendChild(b);
  });
}
function select(b){
  b.style.display='none';
  const s=document.createElement('span');
  s.className='bubble selected';s.textContent=b.textContent;
  s.onclick=()=>{s.remove();b.style.display='inline-block';};
  document.getElementById('translationLine').appendChild(s);
}
function checkSentence(){
  const u=[...document.querySelectorAll('#translationLine span')].map(s=>s.textContent).join(' ');
  if(u===current[1]){idx++;idx<seq.length?showSentence():goHome();}
  else document.querySelectorAll('#translationLine span').forEach((s,i)=>{
    if(s.textContent!==current[1].split(' ')[i])s.classList.add('incorrect');
  });
}

/* BEAT THE CLOCK */
let time=120,score=0,timerInt;
function startBeatTheClock(){
  score=0;time=120;
  show('screen-timer');
  timerInt=setInterval(()=>{
    time--;document.getElementById('timer').textContent=`${Math.floor(time/60)}:${String(time%60).padStart(2,'0')}`;
    if(time<=0){clearInterval(timerInt);alert(`Time's up! Score: ${score}`);goHome();}
  },1000);
  nextClock();
}
function nextClock(){
  const all=Object.values(lessons).flat();
  const w=all[Math.floor(Math.random()*all.length)];
  document.getElementById('clockWord').textContent=w[0];
  const opts=shuffle([w[1],...shuffle(all.map(x=>x[1])).slice(0,2)]);
  const c=document.getElementById('clockOptions');c.innerHTML='';
  opts.forEach(o=>{
    const b=document.createElement('div');
    b.className='bubble';b.textContent=o;
    b.onclick=()=>{if(o===w[1]){score++;document.getElementById('score').textContent=`Score: ${score}`;nextClock();}};
    c.appendChild(b);
  });
}

/* CONTEXT */
function startContext(){show('screen-context');}

/* UTILITY */
function shuffle(a){return a.sort(()=>Math.random()-0.5);}
</script>
</body>
</html>
