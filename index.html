<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Norsk Buddy</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
:root {
  --bg: #0f172a;
  --panel: #111827;
  --card: #1f2933;
  --accent: #38bdf8;
  --text: #e5e7eb;
  --muted: #9ca3af;
}

body.jp {
  --bg: #120a18;
  --panel: #1b1024;
  --card: #241433;
  --accent: #f472b6;
  --text: #fde8f3;
  --muted: #d1b3c4;
}

body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: var(--bg);
  color: var(--text);
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background: var(--panel);
}

#langToggle {
  display: flex;
  gap: 12px;
}

.flag {
  font-size: 26px;
  cursor: pointer;
  opacity: 0.4;
  transition: transform 0.15s, opacity 0.15s;
}

.flag.active {
  opacity: 1;
  transform: scale(1.1);
}

main {
  padding: 16px;
}

.section {
  background: var(--panel);
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 16px;
}

.lesson {
  background: var(--card);
  border-radius: 10px;
  padding: 12px;
  margin-top: 10px;
}

.word {
  cursor: pointer;
  border-bottom: 1px dotted var(--accent);
}

.word:hover {
  color: var(--accent);
}

.bubbles {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 12px;
}

.bubble {
  padding: 6px 10px;
  background: var(--panel);
  border-radius: 999px;
  cursor: pointer;
  user-select: none;
}

.bubble.selected {
  background: var(--accent);
  color: #000;
}

.feedback-wrong {
  animation: shake 0.25s;
  background: #7f1d1d !important;
}

@keyframes shake {
  0% { transform: translateX(0); }
  25% { transform: translateX(-3px); }
  50% { transform: translateX(3px); }
  75% { transform: translateX(-3px); }
  100% { transform: translateX(0); }
}
</style>
</head>

<body>
<header>
  <strong>Norsk Buddy</strong>
  <div id="langToggle">
    <span class="flag active" data-lang="no">ðŸ‡³ðŸ‡´</span>
    <span class="flag" data-lang="jp">ðŸ‡¯ðŸ‡µ</span>
  </div>
</header>

<main id="app"></main>

<script>
/* ======================================================
   LANGUAGE STATE
====================================================== */
let currentLang = "no";

const AUDIO_PATHS = {
  no: "Norsk-Buddy-Audio/",
  jp: "Norsk-Buddy-Audio-Japan/"
};

/* ======================================================
   LESSON DATA (STRUCTURE UNCHANGED)
   Japanese mirrors Norwegian lessons exactly
====================================================== */
const LESSONS = {
  no: {
    sections: [
      {
        title: "Section 1 â€“ The Basics",
        lessons: [
          {
            title: "Who, What, Why, and Where",
            words: [
              { word: "hvem", en: "who", example: "Hvem er du?" },
              { word: "hva", en: "what", example: "Hva gjÃ¸r du?" },
              { word: "hvor", en: "where", example: "Hvor bor du?" },
              { word: "hvorfor", en: "why", example: "Hvorfor er du her?" },
              { word: "nÃ¥r", en: "when", example: "NÃ¥r kommer du?" }
            ]
          }
        ]
      }
    ]
  },

  jp: {
    sections: [
      {
        title: "Section 1 â€“ åŸºæœ¬ (The Basics)",
        lessons: [
          {
            title: "Who, What, Why, and Where",
            words: [
              { word: "èª°", romaji: "dare", en: "who", example: "èª°ã§ã™ã‹ï¼Ÿ" },
              { word: "ä½•", romaji: "nani", en: "what", example: "ä½•ã‚’ã—ã¾ã™ã‹ï¼Ÿ" },
              { word: "ã©ã“", romaji: "doko", en: "where", example: "ã©ã“ã«ä½ã‚“ã§ã„ã¾ã™ã‹ï¼Ÿ" },
              { word: "ãªãœ", romaji: "naze", en: "why", example: "ãªãœã“ã“ã«ã„ã¾ã™ã‹ï¼Ÿ" },
              { word: "ã„ã¤", romaji: "itsu", en: "when", example: "ã„ã¤æ¥ã¾ã™ã‹ï¼Ÿ" }
            ]
          }
        ]
      }
    ]
  }
};

/* ======================================================
   RENDERING
====================================================== */
function renderApp() {
  const app = document.getElementById("app");
  app.innerHTML = "";

  const data = LESSONS[currentLang];

  data.sections.forEach(section => {
    const sec = document.createElement("div");
    sec.className = "section";
    sec.innerHTML = `<h2>${section.title}</h2>`;

    section.lessons.forEach(lesson => {
      const les = document.createElement("div");
      les.className = "lesson";
      les.innerHTML = `<h3>${lesson.title}</h3>`;

      lesson.words.forEach(w => {
        const p = document.createElement("p");
        p.innerHTML = `
          <span class="word" data-audio="${w.word}">
            ${w.word}${w.romaji ? " (" + w.romaji + ")" : ""}
          </span>
          â€“ ${w.example}
        `;
        les.appendChild(p);
      });

      sec.appendChild(les);
    });

    app.appendChild(sec);
  });

  bindWordAudio();
}

/* ======================================================
   AUDIO HANDLING (PATH SWITCH ONLY)
====================================================== */
function bindWordAudio() {
  document.querySelectorAll(".word").forEach(el => {
    el.addEventListener("click", () => {
      const audioFile = AUDIO_PATHS[currentLang] + el.dataset.audio + ".mp3";
      const audio = new Audio(audioFile);
      audio.play().catch(() => {});
    });
  });
}

/* ======================================================
   LANGUAGE TOGGLE
====================================================== */
document.querySelectorAll(".flag").forEach(flag => {
  flag.addEventListener("click", () => {
    document.querySelectorAll(".flag").forEach(f => f.classList.remove("active"));
    flag.classList.add("active");

    currentLang = flag.dataset.lang;
    document.body.classList.toggle("jp", currentLang === "jp");

    renderApp();
  });
});

/* ======================================================
   INIT
====================================================== */
renderApp();
</script>
</body>
</html>
