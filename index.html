<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Norsk Buddy</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: linear-gradient(135deg, #1cb0f6, #58cc02);
}

.app {
  max-width: 480px;
  margin: auto;
  background: #fff;
  min-height: 100vh;
  padding: 20px;
  position: relative;
}

h1, h2 { text-align: center; }
.hidden { display: none; }

button {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  font-size: 16px;
  border: none;
  border-radius: 12px;
  background: #58cc02;
  color: white;
  cursor: pointer;
}

button.secondary { background: #1cb0f6; }

.mascot {
  width: 110px;
  display: block;
  margin: 10px auto;
}

.lesson-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 14px;
  margin-top: 20px;
}

.lesson {
  background: #f0f8ff;
  border-radius: 16px;
  padding: 16px;
  text-align: center;
  cursor: pointer;
}

#prev {
  position: absolute;
  top: 12px;
  left: 12px;
  width: auto;
  padding: 8px 14px;
}

.match {
  display: flex;
  gap: 10px;
}

.col { flex: 1; }

.option {
  background: #eee;
  color: #333;
}

.option.selected { background: #1cb0f6; color: white; }
.option.matched { background: #58cc02; color: white; }
</style>
</head>

<body>
<div class="app">

<h1>üá≥üá¥ Norsk Buddy</h1>
<img class="mascot" src="assets/mascots/mascot-man.png">

<!-- GOALS -->
<div id="screen-goals" class="hidden">
  <h2>What are your ambitions for learning Norsk?</h2>
  <button onclick="setGoal()">Visiting Norway</button>
  <button onclick="setGoal()">Curious about the language</button>
  <button onclick="setGoal()">Conversational fluency</button>
  <button onclick="setGoal()">Business fluency</button>
</div>

<!-- HOME -->
<div id="screen-home" class="hidden">
  <h2>Your Journey</h2>
  <div class="lesson-grid" id="lessonGrid"></div>
</div>

<!-- LESSON -->
<div id="screen-lesson" class="hidden">
  <button id="prev" onclick="goHome()">‚Üê Home</button>
  <h2 id="word-no"></h2>
  <p><strong>English:</strong> <span id="word-en"></span></p>
  <button class="secondary" onclick="playAudio()">üîä Play</button>
  <button onclick="nextWord()">Next</button>
</div>

<!-- MATCH -->
<div id="screen-match" class="hidden">
  <h2>Match the words</h2>
  <div class="match">
    <div class="col" id="en-col"></div>
    <div class="col" id="no-col"></div>
  </div>
</div>

</div>

<script>
/* ========= LESSON DATA ========= */

const lessons = {
  greetings: [
    ['Hallo','Hello'],['Ha det','Goodbye']
  ],
  courtesy: [
    ['V√¶r s√• snill','Please'],['Takk','Thank you']
  ],
  needs: [
    ['Vann','Water'],['Mat','Food']
  ],
  numbers: [
    ['En','One'],['To','Two'],['Tre','Three'],['Fire','Four'],['Fem','Five'],
    ['Seks','Six'],['Sju','Seven'],['√Ötte','Eight'],['Ni','Nine'],['Ti','Ten']
  ],
  slang: [
    ['Hva skjer','What‚Äôs up'],['Kult','Cool'],['Slapp av','Chill']
  ],

  whWords: [
    ['hvem','who'],['hva','what'],['hvor','where'],['hvorfor','why'],['n√•r','when'],
    ['gikk','went'],['g√•r','is going'],['vil g√•','will go'],['har g√•tt','has went'],
    ['hvem er','who is'],['hvem var','who was'],['hvem vil','who will'],
    ['hva er','what is'],['hva har','what has'],['hva vil','what will'],
    ['hvor er','where is'],['hvor har','where has'],['hvor vil','where will'],
    ['n√•r har','when has'],['n√•r vil','when will'],['n√•r er','when is'],
    ['hvorfor er det','why is'],['hvorfor har','why has'],['hvorfor vil','why will']
  ],

  colors: [
    ['r√∏d','red'],['bl√•','blue'],['gul','yellow'],['guld','gold'],['lilla','purple'],
    ['rosa','pink'],['gr√∏n','green'],['brun','brown'],['svart','black'],['hvit','white']
  ],

  professions: [
    ['ingeni√∏r','engineer'],['politi','police'],['politimann','policeman'],
    ['politikvinne','policewoman'],['postbud','postman'],['kokk','chef'],
    ['bygningsarbeider','construction worker'],['bussj√•f√∏r','bus driver'],['l√¶rer','teacher']
  ],

  feelings: [
    ['f√∏lelse','feeling'],['f√∏lelser','feelings'],['f√∏les','feels'],
    ['vil f√∏le','will feel'],['f√∏lte','felt'],
    ['glad','happy'],['trist','sad'],['sint','mad'],['spennende','exciting']
  ],

  theirThere: [
    ['der','there'],['deres','their'],['de er','they are']
  ]
};

/* ========= STATE ========= */

let sequence=[], index=0, lessonKey=null, selected=null, matched=0;

/* ========= INIT ========= */

const lessonNames = {
  greetings:'Greetings',courtesy:'Courtesy',needs:'Needs',numbers:'Numbers',
  slang:'Slang',whWords:'Who / What / Where',colors:'Colors',
  professions:'Professions',feelings:'Feelings',theirThere:'Their / There'
};

const grid = document.getElementById('lessonGrid');
for (let k in lessonNames) {
  const d=document.createElement('div');
  d.className='lesson';
  d.innerHTML='‚õ∞Ô∏è<br>'+lessonNames[k];
  d.onclick=()=>startLesson(k);
  grid.appendChild(d);
}

function setGoal(){
  localStorage.setItem('goal','1');
  show('screen-home');
}

function show(id){
  document.querySelectorAll('[id^=screen]').forEach(s=>s.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

function startLesson(key){
  lessonKey=key;
  index=0;
  matched=0;
  sequence=buildSequence(lessons[key]);
  show('screen-lesson');
  showWord();
}

function buildSequence(arr){
  let base=[...arr];
  let extras=[];
  base.forEach((w,i)=>{
    if(i>1 && Math.random()<0.4) extras.push(w);
  });
  return shuffle([...base,...extras]);
}

function shuffle(a){return a.sort(()=>Math.random()-0.5);}

function showWord(){
  document.getElementById('word-no').textContent=sequence[index][0];
  document.getElementById('word-en').textContent=sequence[index][1];
}

function nextWord(){
  if(index<sequence.length-1){index++;showWord();}
  else startMatch();
}

function playAudio(){
  const f=`Norsk-Buddy-Audio/${sequence[index][0]}.mp3`;
  new Audio(f).play().catch(()=>{});
}

/* ========= MATCH ========= */

function startMatch(){
  show('screen-match');
  const en=document.getElementById('en-col');
  const no=document.getElementById('no-col');
  en.innerHTML=no.innerHTML='';
  selected=null; matched=0;

  const shuffled=shuffle([...lessons[lessonKey]]);
  lessons[lessonKey].forEach(w=>{
    const b=document.createElement('button');
    b.className='option';
    b.textContent=w[1];
    b.onclick=()=>{select(b,w)};
    en.appendChild(b);
  });

  shuffled.forEach(w=>{
    const b=document.createElement('button');
    b.className='option';
    b.textContent=w[0];
    b.onclick=()=>check(b,w);
    no.appendChild(b);
  });
}

function select(btn,w){
  clear('en-col');
  btn.classList.add('selected');
  selected=w;
}

function check(btn,w){
  if(!selected) return;
  if(w[0]===selected[0]){
    btn.classList.add('matched');
    matched++;
    if(matched===lessons[lessonKey].length){
      alert('Lesson complete!');
      goHome();
    }
  } else {
    btn.style.background='red';
    setTimeout(()=>btn.style.background='',800);
  }
  selected=null;
}

function clear(id){
  document.querySelectorAll('#'+id+' .option').forEach(b=>b.classList.remove('selected'));
}

function goHome(){ show('screen-home'); }

if(localStorage.getItem('goal')) show('screen-home'); else show('screen-goals');
</script>

</body>
</html>
